# PR → Jira 티켓 변환 규칙

## 트리거 조건
`docs/` 브랜치가 `main`으로 merge된 PR

---

## 분석 단계

### 1단계: 변경 기능 추출

PR에서 다음 정보를 추출한다:

1. **PR 제목/본문**에서 `[SPEC]` 태그로 명시된 기능 코드 수집
2. **커밋 메시지**에서 `[SPEC]` 라인의 기능 코드 수집
3. **diff**에서 `docs/pages/*.md` 파일의 변경 섹션 헤더(`#### CODE-NNN`) 감지

위 3가지를 교차 검증하여 누락 없이 변경된 기능 코드 목록을 확정한다.

---

### 2단계: 변경 유형 분류

각 기능 코드별 변경 유형을 판별한다:

| 변경 유형 | 판별 기준 |
|-----------|-----------|
| **신규(new)** | 이전에 없던 기능 코드가 추가됨 |
| **수정(update)** | 기존 기능 코드의 콘텐츠/인터랙션/테스트 시나리오가 변경됨 |
| **삭제(remove)** | 기존 기능 코드가 제거됨 |

---

### 3단계: 팀 할당

변경된 기능의 속성을 분석하여 팀을 할당한다.

#### 할당 규칙

커밋의 `[TEAM]` 라인을 기준으로 팀을 할당한다. 1커밋 = 1팀이므로 티켓도 1:1로 생성된다.

| 변경 내용 | 팀 |
|-----------|------|
| 와이어프레임, 레이아웃, UI 요소 추가/변경 | **Design** |
| 콘텐츠 테이블의 인터랙션 컬럼 변경 | **Frontend** |
| 데이터 저장/연결 로직 변경 | **Backend** |
| 콘텐츠(텍스트) 변경만 있음 | **Frontend** |
| API 연동 관련 변경 | **Backend** |
| OG 이미지/SEO 관련 변경 | **Frontend** |
| 테스트 시나리오만 변경 | **QA** (별도 티켓 불필요, 기존 티켓에 업데이트) |

> 하나의 기능 코드가 여러 팀에 영향을 주는 경우 (예: 폼 변경, 점수 계산/분기 로직) 커밋 자체가 팀별로 분리되어 있으므로 각 커밋에서 티켓을 1:1로 생성한다.

---

### 4단계: 참고 리소스 연결

팀별로 참고해야 할 리소스를 자동 연결한다:

| 팀 | 참고 리소스 |
|----|-------------|
| **Design** | `sleepthera-docs` 레포 > `docs/wireframes/` |
| **Frontend** | `sleepthera-landing-page` 레포 > `CLAUDE.md` |
| **Backend** | `sleepthera-landing-page-server` 레포 > `CLAUDE.md` |

---

### 5단계: 작업 규모 산정

변경 유형과 영향 범위를 기반으로 작업 규모를 산정한다.

#### 산정 기준

| 규모 | 기준 |
|------|------|
| **1** | 텍스트/콘텐츠만 변경 |
| **2** | 단일 컴포넌트 속성 변경 (스타일, 인터랙션 수정) |
| **4** | 컴포넌트 신규 추가 또는 기존 컴포넌트 구조 변경 |
| **8** | 복수 컴포넌트 연동 변경 또는 새로운 플로우 추가 |
| **16** | 페이지 단위 변경 또는 복잡한 로직 변경 |

#### 보정 요소
- 기존 구현이 있는 코드 수정 → 규모 유지 또는 한 단계 감소
- 신규 기능으로 기존 코드에 없는 패턴 → 한 단계 증가
- 디자인/백엔드 의존성이 있는 경우 → 티켓에 blocker 명시

---

## 티켓 생성 규칙

### 티켓 단위
- **커밋 1개 = 티켓 1개** (기본). 커밋이 이미 1 SPEC + 1 TEAM으로 분리되어 있으므로 그대로 티켓으로 변환한다.
- 동일 섹션 내 밀접하게 연관된 변경은 합칠 수 있음 (예: REG-002-a, REG-002-b, REG-002-c 같은 팀 → 티켓 1개)

### 티켓 제목 형식
```
[<팀>] <기능코드> <변경요약>
```

**예시:**
- `[FE] LAND-002 Hero 섹션 CTA 인터랙션 추가`
- `[BE] REG-003 등록 API 중복 이메일 처리`
- `[Design] LAND-007 후기 캐러셀 와이어프레임 업데이트`

### PR 단위 묶음
하나의 PR에서 생성된 모든 티켓은 Epic 또는 Label로 묶는다:
- **Epic:** PR 제목의 프로젝트명 사용
- **Label:** `spec/<branch-name>`
